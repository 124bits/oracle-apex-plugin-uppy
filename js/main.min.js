const UPPY=window.UPPY||{};UPPY.plugin=UPPY.plugin||{},UPPY.plugin.init=(context,initFn)=>{const{action:action}=context,plugin={ajaxIdentifier:action.ajaxIdentifier,restrictions:JSON.parse(action.attribute01),dashboardOptions:JSON.parse(action.attribute02),targetElement:action.attribute04,additionalFeatures:action.attribute05||"empty",usePresignUrl:"Y"===action.attribute07,theme:action.attribute08,onCompleteCallback:action.attribute09,localePack:action.attribute10,destination:action.attribute11,uppyId:action.attribute12||Date.now(),uploadLinkObjectKey:action.attribute13,onUploadSuccess:action.attribute14,compressOptions:JSON.parse(action.attribute15)},uppy=new Uppy.Uppy({locale:Uppy.locales[plugin.localePack],id:plugin.uppyId,restrictions:plugin.restrictions});uppy.use(Uppy.Dashboard,{proudlyDisplayPoweredByUppy:!1,target:plugin.targetElement,inline:!0,showProgressDetails:!0,theme:plugin.theme,hideProgressAfterFinish:!0,...plugin.dashboardOptions});const addFeature=(t,e,a={})=>{plugin.additionalFeatures.includes(t)&&uppy.use(e,a)};return addFeature("COMPRESS_IMAGES",Uppy.Compressor,{...plugin.compressOptions}),addFeature("IMAGE_EDITOR",Uppy.ImageEditor,{target:Uppy.Dashboard}),addFeature("AUDIO",Uppy.Audio,{target:Uppy.Dashboard,showAudioSourceDropdown:!0}),addFeature("WEBCAM",Uppy.Webcam,{target:Uppy.Dashboard,showVideoSourceDropdown:!0}),addFeature("SCREEN_CAPTURE",Uppy.ScreenCapture,{target:Uppy.Dashboard}),addFeature("GOLDEN_RETRIEVER",Uppy.GoldenRetriever,{serviceWorker:!0}),"AwsS3"===plugin.destination&&uppy.use(Uppy[plugin.destination],{async getUploadParameters(t){let e;plugin.usePresignUrl&&await apex.server.plugin(plugin.ajaxIdentifier,{x01:t.name,x02:t.type,x03:t.extension,x04:t.size},{success:t=>e=t});const a={"Content-Type":`${t.type}; charset=utf-8`,...plugin.additionalFeatures.includes("ATTACHMENT")&&{"Content-Disposition":`attachment; filename="${t.name}"`}};return{method:"put",url:e[plugin.uploadLinkObjectKey],fields:e,headers:a}}}),uppy.on("upload-success",eval(plugin.onUploadSuccess)),uppy.on("complete",eval(plugin.onCompleteCallback)),"function"==typeof initFn&&initFn.call(context,uppy),uppy};